<script>
const cards = Array.from(document.querySelectorAll(".product-card"));
const container = document.getElementById("products");
const searchInput = document.getElementById("searchInput");

/* EXPAND + SUGGESTION LOGIC */
cards.forEach(card => {
  card.addEventListener("click", () => {

    // clear big view
    cards.forEach(c => c.classList.remove("big-product"));

    const selectedCategory = card.dataset.category;

    // split products
    const sameCategory = cards.filter(
      c => c.dataset.category === selectedCategory && c !== card && c.style.display !== "none"
    );

    const otherCategory = cards.filter(
      c => c.dataset.category !== selectedCategory && c.style.display !== "none"
    );

    // rebuild grid
    container.innerHTML = "";

    card.classList.add("big-product");
    container.appendChild(card);

    // first show same category
    sameCategory.forEach(c => {
      c.classList.remove("big-product");
      container.appendChild(c);
    });

    // then show others
    otherCategory.forEach(c => {
      c.classList.remove("big-product");
      container.appendChild(c);
    });

    window.scrollTo({ top: 0, behavior: "smooth" });
  });
});

/* SEARCH (ALWAYS WORKS) */
searchInput.addEventListener("keyup", () => {
  const value = searchInput.value.toLowerCase();

  cards.forEach(card => {
    const text = card.innerText.toLowerCase();
    if (text.includes(value)) {
      card.style.display = "block";
    } else {
      card.style.display = "none";
      card.classList.remove("big-product");
    }
  });

  // reset order when search cleared
  if (value === "") {
    container.innerHTML = "";
    cards.forEach(card => {
      card.style.display = "block";
      card.classList.remove("big-product");
      container.appendChild(card);
    });
  }
});
</script>
