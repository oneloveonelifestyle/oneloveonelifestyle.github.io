<script src="products.js"></script>
<script>
const container = document.getElementById("products");
const vaultCount = document.getElementById("vaultCount");

let vault = JSON.parse(localStorage.getItem("vault")) || [];
vaultCount.textContent = vault.length;

PRODUCTS.filter(p => p.category === "shoes").forEach(product => {
  const card = document.createElement("div");
  card.className = "product-card";
  card.dataset.id = product.id;

  card.innerHTML = `
    <div class="slider">
      ${product.images.map(i => `<img src="${i}">`).join("")}
    </div>
    <div class="details">
      <h2>${product.title}</h2>
      <div class="price">${product.price}</div>
      <div class="full-description">${product.description}</div>
      <button class="vault-btn">♡ Save to Vault</button>
      <a class="order-btn">${product.price}</a>
    </div>
  `;

  setup(card, product.id);
  container.appendChild(card);
});

function setup(card, id) {
  const btn = card.querySelector(".vault-btn");

  if (vault.includes(id)) {
    btn.textContent = "✕ Remove from Vault";
    btn.classList.add("remove");
  }

  card.addEventListener("click", e => {
    if (e.target.closest(".vault-btn")) return;
    document.querySelectorAll(".product-card").forEach(c => c.classList.remove("big-product"));
    card.classList.add("big-product");
    container.prepend(card);
  });

  btn.addEventListener("click", e => {
    e.stopPropagation();
    if (vault.includes(id)) {
      vault = vault.filter(v => v !== id);
      btn.textContent = "♡ Save to Vault";
      btn.classList.remove("remove");
    } else {
      vault.push(id);
      btn.textContent = "✕ Remove from Vault";
      btn.classList.add("remove");
    }
    localStorage.setItem("vault", JSON.stringify(vault));
    vaultCount.textContent = vault.length;
  });
}
</script>
