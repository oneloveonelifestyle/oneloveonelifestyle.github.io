<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shoes</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="products-container" id="productsContainer"></div>

<script src="products.js"></script>

<script>
const container = document.getElementById("productsContainer");

let vault = JSON.parse(localStorage.getItem("vault")) || [];

function saveToVault(id) {
  if (!vault.includes(id)) {
    vault.push(id);
    localStorage.setItem("vault", JSON.stringify(vault));
  }
}

function removeFromVault(id) {
  vault = vault.filter(v => v !== id);
  localStorage.setItem("vault", JSON.stringify(vault));
}

PRODUCTS.filter(p => p.category === "shoe").forEach(product => {

  const card = document.createElement("div");
  card.className = "product-card";

  const isSaved = vault.includes(product.id);

  card.innerHTML = `
    <div class="slider">
      ${product.images.map(img => `<img src="${img}">`).join("")}
    </div>

    <div class="details">
      <h3>${product.title}</h3>

      <div class="price">
        <span class="current-price">${product.price}</span>
      </div>

      ${!product.stock ? `<div class="out-stock">Out of Stock</div>` : ``}

      <div class="actions">
        <button class="vault-btn">
          ${isSaved ? "Remove from Vault" : "Save to Vault"}
        </button>

        ${
          product.stock
            ? `<a class="order-btn"
                 href="https://www.instagram.com/oneloveonelifestyle/"
                 target="_blank">
                 Buy via Instagram
               </a>`
            : ``
        }
      </div>
    </div>
  `;

  /* ðŸ”’ CARD CLICK (FIXED â€” DOES NOT BLOCK SAVE BUTTON) */
  card.addEventListener("click", e => {
    if (
      e.target.closest(".vault-btn") ||
      e.target.closest(".order-btn")
    ) return;

    document.querySelectorAll(".product-card")
      .forEach(c => c.classList.remove("big-product"));

    card.classList.add("big-product");
    container.prepend(card);

    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  /* âœ… VAULT BUTTON */
  card.querySelector(".vault-btn").addEventListener("click", e => {
    e.stopPropagation();

    if (vault.includes(product.id)) {
      removeFromVault(product.id);
      e.target.textContent = "Save to Vault";
    } else {
      saveToVault(product.id);
      e.target.textContent = "Remove from Vault";
    }
  });

  /* prevent bubbling */
  const orderBtn = card.querySelector(".order-btn");
  if (orderBtn) {
    orderBtn.addEventListener("click", e => e.stopPropagation());
  }

  container.appendChild(card);
});
</script>

</body>
</html>
