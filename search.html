<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Search Results</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f4f4f4;
}

header{
  background:#000;
  color:#fff;
  padding:20px;
  text-align:center;
}

.container{
  padding:20px;
}

.result-title{
  font-size:18px;
  font-weight:bold;
  margin-bottom:20px;
}

.product-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:15px;
}

.product-card{
  background:#fff;
  border-radius:14px;
  padding:12px;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
}

.product-img{
  height:130px;
  background:#eaeaea;
  border-radius:10px;
  margin-bottom:8px;
}

.no-results{
  background:#fff;
  padding:30px;
  border-radius:14px;
  text-align:center;
  margin-bottom:30px;
}

.suggest-title{
  margin:30px 0 15px;
  font-weight:bold;
}
</style>
</head>

<body>

<header>
  <h1>Search Results</h1>
</header>

<div class="container">
  <div id="resultsInfo" class="result-title"></div>
  <div id="results" class="product-grid"></div>
  <div id="suggestions"></div>
</div>

<!-- ✅ IMPORTANT: LOAD PRODUCTS -->
<script src="products.js"></script>

<script>
/* SAFETY CHECK */
if (typeof products === "undefined") {
  document.getElementById("resultsInfo").innerText =
    "Products data not loaded.";
  throw new Error("products.js not loaded or variable name mismatch");
}

/* GET SEARCH QUERY */
const params = new URLSearchParams(window.location.search);
const query = (params.get("q") || "").toLowerCase();

document.getElementById("resultsInfo").innerText =
  `Results for "${query}"`;

/* MATCH PRODUCTS */
const matched = products.filter(p =>
  p.name.toLowerCase().includes(query)
);

/* RENDER FUNCTION */
function renderProducts(list, containerId){
  const container = document.getElementById(containerId);
  container.innerHTML = "";

  list.forEach(p => {
    const div = document.createElement("div");
    div.className = "product-card";
    div.innerHTML = `
      <div class="product-img"></div>
      <div><b>${p.name}</b></div>
      <div>₹${p.price}</div>
    `;
    container.appendChild(div);
  });
}

/* RESULTS LOGIC */
if (matched.length > 0) {
  renderProducts(matched, "results");
} else {
  document.getElementById("results").innerHTML = `
    <div class="no-results">
      <h3>No results found</h3>
      <p>We couldn’t find any products matching "<b>${query}</b>".</p>
      <p>Check the spelling or explore similar items below.</p>
    </div>
  `;
}

/* SUGGEST OTHER PRODUCTS */
const suggestions = products.slice(0, 4);
document.getElementById("suggestions").innerHTML = `
  <div class="suggest-title">You may also like</div>
  <div class="product-grid" id="suggestGrid"></div>
`;
renderProducts(suggestions, "suggestGrid");
</script>

</body>
</html>
