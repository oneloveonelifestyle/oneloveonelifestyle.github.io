<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Search Results</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f5f5f5;
}

header{
  background:#000;
  color:#fff;
  padding:14px;
  text-align:center;
  position:relative;
}

header a{
  position:absolute;
  left:14px;
  top:14px;
  color:#fff;
  text-decoration:none;
  font-weight:bold;
}

.section-title{
  padding:14px 14px 6px;
  font-weight:bold;
  font-size:14px;
}

.products-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
  padding:12px;
}

.product-card{
  background:#fff;
  border-radius:10px;
  overflow:hidden;
  box-shadow:0 2px 8px rgba(0,0,0,.08);
  cursor:pointer;
}

.slider{
  display:flex;
  overflow-x:auto;
}

.slider img{
  width:100%;
  display:block;
}

.details{
  padding:10px;
}

.details h3{
  font-size:13px;
  margin:0 0 4px;
}

.price{
  font-weight:bold;
  font-size:13px;
}

.no-results{
  padding:40px 20px;
  text-align:center;
  color:#444;
}
</style>
</head>

<body>

<header>
  <a href="index.html">← Home</a>
  <h2>Search Results</h2>
</header>

<div id="content"></div>

<script src="products.js"></script>

<script>
const params = new URLSearchParams(window.location.search);
const keyword = (params.get("q") || "").toLowerCase().trim();
const container = document.getElementById("content");

function scoreProduct(p){
  let score = 0;
  const title = p.title.toLowerCase();
  const search = (p.search || "").toLowerCase();

  if(title === keyword) score += 100;              // exact title match
  if(title.includes(keyword)) score += 60;         // title contains
  if(search.includes(keyword)) score += 30;        // tag/search match

  return score;
}

function renderProducts(list){
  const grid = document.createElement("div");
  grid.className = "products-grid";

  list.forEach(p=>{
    const card = document.createElement("div");
    card.className = "product-card";

    card.innerHTML = `
      <div class="slider">
        ${p.images.map(img=>`<img src="${img}">`).join("")}
      </div>
      <div class="details">
        <h3>${p.title}</h3>
        <div class="price">${p.price}</div>
      </div>
    `;

    card.onclick = ()=>{
      localStorage.setItem("openProduct", p.id);
      if(p.category === "clothing") location.href="clothing.html";
      else if(p.category === "shoe") location.href="shoes.html";
      else location.href="accessories.html";
    };

    grid.appendChild(card);
  });

  container.appendChild(grid);
}

if(!keyword){
  container.innerHTML = `
    <div class="no-results">
      <h2>Please enter a search term</h2>
    </div>
  `;
}else{

  const ranked = PRODUCTS
    .map(p=>({ product:p, score:scoreProduct(p) }))
    .sort((a,b)=>b.score - a.score);

  const matches = ranked.filter(r=>r.score > 0).map(r=>r.product);
  const suggestions = ranked.filter(r=>r.score === 0).map(r=>r.product);

  if(matches.length === 0){
    container.innerHTML = `
      <div class="no-results">
        <h2>No results for “${keyword}”</h2>
        <p>Check your spelling or explore similar products below.</p>
      </div>
    `;
    renderProducts(suggestions);
  }else{
    const title = document.createElement("div");
    title.className = "section-title";
    title.textContent = "Results for \"" + keyword + "\"";
    container.appendChild(title);

    renderProducts(matches);

    if(suggestions.length){
      const sug = document.createElement("div");
      sug.className = "section-title";
      sug.textContent = "You might also like";
      container.appendChild(sug);

      renderProducts(suggestions);
    }
  }
}
</script>

</body>
</html>
